{% load static %}
{% load tailwind_tags %}
<!DOCTYPE html>
<html lang="en">
{% include 'home/includes/base.html' %}
<body>
    <!-- Animated Background -->
    <div class="background"></div>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>

    <div class="dashboard">
        <!-- Sidebar -->
        {% include 'home/includes/body.html' %}

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Navbar -->
            <nav class="navbar">
                <div class="page-header">
                    <a href="{% url 'user' %}"><h1 class="page-title">Messagerie</h1></a>
                    <div class="page-breadcrumb">
                        <a href="{% url 'user' %}">Dashboard</a>
                        <span>/</span>
                        <span>Messages</span>
                    </div>
                </div>
                <div class="navbar-right">
                    <div class="search-box">
                        <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
                        </svg>
                        <input type="text" class="search-input" placeholder="Search messages...">
                    </div>
                    <button class="nav-btn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/>
                        </svg>
                        <span class="notification-dot"></span>
                    </button>
                    <button class="nav-btn" id="theme-toggle" title="Toggle Light/Dark Mode">
                        <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/>
                            <path d="M4.93 4.93l1.41 1.41"/><path d="M17.66 17.66l1.41 1.41"/>
                            <path d="M2 12h2"/><path d="M20 12h2"/>
                            <path d="M6.34 17.66l-1.41 1.41"/><path d="M19.07 4.93l-1.41 1.41"/>
                        </svg>
                        <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </button>
                </div>
            </nav>

            <!-- Stats Cards -->
            <section class="stats-grid">
                <div class="glass-card glass-card-3d stat-card">
                    <div class="stat-card-inner">
                        <div class="stat-info">
                            <h3>Total Messages</h3>
                            <div class="stat-value">127</div>
                            <span class="stat-change positive">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/></svg>
                                +12.3%
                            </span>
                        </div>
                        <div class="stat-icon cyan">
                            <svg viewBox="0 0 24 24" fill="none" stroke="var(--emerald-light)" stroke-width="2">
                                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="glass-card glass-card-3d stat-card">
                    <div class="stat-card-inner">
                        <div class="stat-info">
                            <h3>Non Lus</h3>
                            <div class="stat-value">3</div>
                            <span class="stat-change positive">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/></svg>
                                Nouveau
                            </span>
                        </div>
                        <div class="stat-icon magenta">
                            <svg viewBox="0 0 24 24" fill="none" stroke="var(--gold)" stroke-width="2">
                                <path d="M22 17H2a3 3 0 0 0 3-3V9a7 7 0 0 1 14 0v5a3 3 0 0 0 3 3zm-8.27 4a2 2 0 0 1-3.46 0"/>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="glass-card glass-card-3d stat-card">
                    <div class="stat-card-inner">
                        <div class="stat-info">
                            <h3>Envoyés</h3>
                            <div class="stat-value">89</div>
                            <span class="stat-change positive">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/></svg>
                                +8.5%
                            </span>
                        </div>
                        <div class="stat-icon purple">
                            <svg viewBox="0 0 24 24" fill="none" stroke="var(--coral)" stroke-width="2">
                                <line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/>
                            </svg>
                        </div>
                    </div>
                </div>

                <div class="glass-card glass-card-3d stat-card">
                    <div class="stat-card-inner">
                        <div class="stat-info">
                            <h3>Archivés</h3>
                            <div class="stat-value">35</div>
                            <span class="stat-change negative">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 18 13.5 8.5 8.5 13.5 1 6"/></svg>
                                -2.1%
                            </span>
                        </div>
                        <div class="stat-icon success">
                            <svg viewBox="0 0 24 24" fill="none" stroke="var(--success)" stroke-width="2">
                                <polyline points="21 8 21 21 3 21 3 8"/><rect x="1" y="3" width="22" height="5"/><line x1="10" y1="12" x2="14" y2="12"/>
                            </svg>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Inbox Split View -->
            <section class="content-grid" style="grid-template-columns: 400px 1fr; gap: 1.5rem;">
                <!-- Message List -->
                <div class="glass-card" style="padding: 0; overflow: hidden;">
                    <div class="card-header" style="padding: 1.5rem; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                        <div>
                            <h2 class="card-title">Boîte de Réception</h2>
                            <p class="card-subtitle">3 messages non lus</p>
                        </div>
                        <div class="card-actions">
                            <button class="card-btn">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="12" y1="5" x2="12" y2="19"/>
                                    <line x1="5" y1="12" x2="19" y2="12"/>
                                </svg>
                                Nouveau
                            </button>
                        </div>
                    </div>
                    
                    <div style="max-height: 600px; overflow-y: auto;">
                        <!-- Message Item 1 - Active & Unread -->
                        <div class="message-item-glass active unread" onclick="selectMessage(0)" style="padding: 1.25rem; border-bottom: 1px solid rgba(255, 255, 255, 0.05); cursor: pointer; transition: all 0.3s ease; position: relative;">
                            <div style="display: flex; gap: 1rem; align-items: start;">
                                <div class="table-avatar" style="background: linear-gradient(135deg, var(--emerald-light), var(--emerald)); min-width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; font-weight: 600;">SC</div>
                                <div style="flex: 1; min-width: 0;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <span style="font-weight: 600; font-size: 0.95rem; color: var(--text-primary);">Sarah Chen</span>
                                        <span style="font-size: 0.75rem; color: var(--text-secondary);">9:45 AM</span>
                                    </div>
                                    <div style="font-weight: 500; font-size: 0.9rem; margin-bottom: 0.4rem; color: var(--text-primary);">Project Update: Q1 Dashboard</div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">Hi Alex, I wanted to give you a quick update on the Q1 dashboard...</div>
                                    <div style="position: absolute; left: 0; top: 50%; transform: translateY(-50%); width: 3px; height: 60%; background: linear-gradient(180deg, var(--emerald-light), var(--emerald)); border-radius: 0 3px 3px 0;"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Message Item 2 - Unread -->
                        <div class="message-item-glass unread" onclick="selectMessage(1)" style="padding: 1.25rem; border-bottom: 1px solid rgba(255, 255, 255, 0.05); cursor: pointer; transition: all 0.3s ease;">
                            <div style="display: flex; gap: 1rem; align-items: start;">
                                <div class="table-avatar" style="background: linear-gradient(135deg, var(--success), #16a34a); min-width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; font-weight: 600;">AB</div>
                                <div style="flex: 1; min-width: 0;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <span style="font-weight: 600; font-size: 0.95rem; color: var(--text-primary);">Analytics Bot</span>
                                        <span style="font-size: 0.75rem; color: var(--text-secondary);">8:00 AM</span>
                                    </div>
                                    <div style="font-weight: 500; font-size: 0.9rem; margin-bottom: 0.4rem; color: var(--text-primary);">Weekly Analytics Report</div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">Here's your weekly analytics summary for December 25-31...</div>
                                </div>
                            </div>
                        </div>

                        <!-- Message Item 3 - Unread -->
                        <div class="message-item-glass unread" onclick="selectMessage(2)" style="padding: 1.25rem; border-bottom: 1px solid rgba(255, 255, 255, 0.05); cursor: pointer; transition: all 0.3s ease;">
                            <div style="display: flex; gap: 1rem; align-items: start;">
                                <div class="table-avatar" style="background: linear-gradient(135deg, #A855F7, #9333EA); min-width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; font-weight: 600;">HR</div>
                                <div style="flex: 1; min-width: 0;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <span style="font-weight: 600; font-size: 0.95rem; color: var(--text-primary);">HR Team</span>
                                        <span style="font-size: 0.75rem; color: var(--text-secondary);">Yesterday</span>
                                    </div>
                                    <div style="font-weight: 500; font-size: 0.9rem; margin-bottom: 0.4rem; color: var(--text-primary);">New Team Member Introduction</div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">We're excited to announce that Michael Torres will be joining...</div>
                                </div>
                            </div>
                        </div>

                        <!-- Message Item 4 - Read -->
                        <div class="message-item-glass" onclick="selectMessage(3)" style="padding: 1.25rem; border-bottom: 1px solid rgba(255, 255, 255, 0.05); cursor: pointer; transition: all 0.3s ease; opacity: 0.8;">
                            <div style="display: flex; gap: 1rem; align-items: start;">
                                <div class="table-avatar" style="background: linear-gradient(135deg, var(--warning), #f59e0b); min-width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; font-weight: 600;">MT</div>
                                <div style="flex: 1; min-width: 0;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <span style="font-weight: 500; font-size: 0.95rem; color: var(--text-primary);">Michael Torres</span>
                                        <span style="font-size: 0.75rem; color: var(--text-secondary);">Dec 30</span>
                                    </div>
                                    <div style="font-weight: 400; font-size: 0.9rem; margin-bottom: 0.4rem; color: var(--text-primary);">Re: API Documentation Review</div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">Thanks for the feedback! I've made the changes you suggested...</div>
                                </div>
                            </div>
                        </div>

                        <!-- Message Item 5 - Read -->
                        <div class="message-item-glass" onclick="selectMessage(4)" style="padding: 1.25rem; border-bottom: 1px solid rgba(255, 255, 255, 0.05); cursor: pointer; transition: all 0.3s ease; opacity: 0.8;">
                            <div style="display: flex; gap: 1rem; align-items: start;">
                                <div class="table-avatar" style="background: linear-gradient(135deg, #ec4899, #db2777); min-width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; font-weight: 600;">JD</div>
                                <div style="flex: 1; min-width: 0;">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                                        <span style="font-weight: 500; font-size: 0.95rem; color: var(--text-primary);">Jane Doe</span>
                                        <span style="font-size: 0.75rem; color: var(--text-secondary);">Dec 28</span>
                                    </div>
                                    <div style="font-weight: 400; font-size: 0.9rem; margin-bottom: 0.4rem; color: var(--text-primary);">Meeting Notes: Design Review</div>
                                    <div style="font-size: 0.85rem; color: var(--text-secondary); overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">Attached are the meeting notes from our design review session...</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Message View -->
                <div class="glass-card" style="display: flex; flex-direction: column; max-height: 780px;">
                    <div class="card-header" style="flex-shrink: 0;">
                        <div style="width: 100%;">
                            <h2 class="card-title" style="margin-bottom: 1rem;">Project Update: Q1 Dashboard Redesign</h2>
                            <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 1rem;">
                                <div style="display: flex; gap: 1rem; align-items: center;">
                                    <div class="table-avatar" style="background: linear-gradient(135deg, var(--emerald-light), var(--emerald)); min-width: 50px; height: 50px; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 1.1rem;">SC</div>
                                    <div>
                                        <div style="font-weight: 600; font-size: 1rem; color: var(--text-primary); margin-bottom: 0.25rem;">Sarah Chen</div>
                                        <div style="font-size: 0.85rem; color: var(--text-secondary);">sarah.chen@company.com</div>
                                    </div>
                                </div>
                                <div style="text-align: right;">
                                    <div style="font-size: 0.85rem; color: var(--text-secondary);">Jan 2, 2026 at 9:45 AM</div>
                                    <div style="margin-top: 0.5rem; display: flex; gap: 0.5rem; justify-content: flex-end;">
                                        <button class="card-btn" style="padding: 6px 12px; font-size: 0.85rem;">
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 4px;">
                                                <polyline points="9 11 12 14 22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
                                            </svg>
                                            Marquer
                                        </button>
                                        <button class="card-btn" style="padding: 6px 12px; font-size: 0.85rem;">
                                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 4px;">
                                                <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                                            </svg>
                                            Supprimer
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="flex: 1; overflow-y: auto; padding: 1.5rem; line-height: 1.7; color: var(--text-secondary);">
                        <p style="margin-bottom: 1rem;">Hi Alex,</p>
                        <p style="margin-bottom: 1rem;">I wanted to give you a quick update on the Q1 dashboard redesign project. We've completed the wireframes and initial mockups, and the team is ready to move into the development phase.</p>
                        <p style="margin-bottom: 1rem; font-weight: 500; color: var(--text-primary);">Key highlights from our progress:</p>
                        <p style="margin-bottom: 1rem; padding-left: 1rem;">
                            • User research completed with 15 participants<br>
                            • 3 design concepts presented to stakeholders<br>
                            • Final direction approved by leadership<br>
                            • Development sprint starting next Monday
                        </p>
                        <p style="margin-bottom: 1rem;">Could we schedule a quick sync tomorrow to go over the technical requirements? Let me know what time works best for you.</p>
                        <p style="margin-bottom: 0.5rem;">Best regards,<br>Sarah</p>
                    </div>
                    
                    <div style="flex-shrink: 0; padding: 1.5rem; border-top: 1px solid rgba(255, 255, 255, 0.1);">
                        <textarea placeholder="Tapez votre réponse..." style="width: 100%; min-height: 100px; padding: 1rem; background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 12px; color: var(--text-primary); font-family: inherit; resize: vertical; margin-bottom: 1rem;"></textarea>
                        <div style="display: flex; gap: 0.75rem; justify-content: flex-end;">
                            <button class="card-btn" style="background: transparent; border: 1px solid rgba(255, 255, 255, 0.2);">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 6px;">
                                    <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"/>
                                </svg>
                                Joindre
                            </button>
                            <button class="card-btn" style="background: linear-gradient(135deg, var(--emerald-light), var(--emerald));">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 6px;">
                                    <line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/>
                                </svg>
                                Envoyer
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/>
        </svg>
    </button>

    <!-- Footer -->
    <footer class="site-footer">
        <p>Copyright © 2026 <a href="#" target="_blank" rel="nofollow">Gestion Étudiant</a> - Système de Gestion Scolaire</p>
    </footer>

    <script src="{% static 'js/templatemo-glass-admin-script.js' %}"></script>
    
    <style>
        .message-item-glass:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(4px);
        }
        
        .message-item-glass.active {
            background: rgba(16, 185, 129, 0.1);
            border-left: 3px solid var(--emerald);
        }
        
        .message-item-glass.unread {
            background: rgba(255, 255, 255, 0.02);
        }
        
        .message-item-glass.unread .table-avatar {
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.3);
        }
    </style>
    
    <script>
        function selectMessage(index) {
            // Remove active class from all messages
            document.querySelectorAll('.message-item-glass').forEach(item => {
                item.classList.remove('active');
            });
            
            // Add active class to clicked message
            event.currentTarget.classList.add('active');
            event.currentTarget.classList.remove('unread');
            
            // Here you would typically load the message content
            // For now, it just marks the message as read
        }
    </script>
</body>
</html>