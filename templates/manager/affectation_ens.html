{% load static %}
{% load tailwind_tags %}
<!DOCTYPE html>
<html lang="fr-FR">
{% include 'home/includes/base.html' %}
<body>
    <!-- Animated Background -->
    <div class="background"></div>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>

    <div class="dashboard">
        <!-- Sidebar -->
        {% include 'home/includes/body.html' %}

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Navbar -->
            <nav class="navbar">
                <div class="page-header">
                    <h1 class="page-title">Affecter l'enseignant</h1>
                    <div class="page-breadcrumb">
                        <a href="{% url 'index' %}">Dashboard</a>
                        <span>/</span>
                        <span>Inscription</span>
                    </div>
                </div>
                <div class="navbar-right">
                    <button class="nav-btn" id="theme-toggle" title="Toggle Light/Dark Mode">
                        <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="4"/><path d="M12 2v2"/><path d="M12 20v2"/>
                            <path d="M4.93 4.93l1.41 1.41"/><path d="M17.66 17.66l1.41 1.41"/>
                            <path d="M2 12h2"/><path d="M20 12h2"/>
                            <path d="M6.34 17.66l-1.41 1.41"/><path d="M19.07 4.93l-1.41 1.41"/>
                        </svg>
                        <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
                            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
                        </svg>
                    </button>
                </div>
            </nav>

            <!-- Form Card -->
            <section class="content-grid" style="grid-template-columns: 1fr;">
                <div class="glass-card glass-card-3d" style="grid-column: span 1;">
                    <!-- Alert Header -->
                    <div class="card-header" style="border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 20px; margin-bottom: 30px;">
                        <div style="text-align: center; width: 100%;">
                            <h2 class="card-title" style="font-size: 28px; margin-bottom: 10px;">
                                <i class="fas fa-user-check" style="margin-right: 10px; animation: bounce 2s infinite;"></i>
                                AFFECTATIONS DES ENSEIGNANTS
                            </h2>
                            <p class="card-subtitle" style="font-size: 16px;">
                                Gestion des étudiants | Administration scolaire
                            </p>
                        </div>
                    </div>

                    <div style="background: rgba(239, 68, 68, 0.1); border-left: 4px solid #ef4444; padding: 20px; border-radius: 10px; margin-bottom: 30px; text-align: center;">
                        <p style="margin: 0; font-size: 15px;">
                            <strong>NB :</strong> Si vous-voulez inscrit un etudiant, cliquer 
                            <a href="{% url 'inscrit' %}" class="card-btn" style="display: inline-block; margin: 0 8px; padding: 8px 16px;">
                                ici
                            </a> 
                            pour finaliser  inscription.
                        </p>
                    </div>

                    <!-- Form -->
                    <form id="verificationForm" action="/verifier/paiement" method="POST">
                        {% csrf_token %}
                        <div style="display: flex; flex-direction: column; gap: 25px; max-width: 600px; margin: 0 auto;">
                            
                                                    <!-- Sélection de l'enseignant -->
                        <div>
                            <label style="display: block; margin-bottom: 10px; font-weight: 500; color: var(--text-primary);">
                                Enseignant <span style="color: #ef4444;">*</span>
                            </label>
                            <div style="position: relative;">
                                <i class="fas fa-id-badge" style="position: absolute; top: 50%; left: 12px; transform: translateY(-50%); color: rgba(255,255,255,0.6); pointer-events: none;"></i>
                                <select 
                                    name="enseignant" 
                                    required
                                    style="width: 100%; padding: 14px 40px 14px 40px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; color: var(--text-primary); font-size: 15px; transition: all 0.3s ease; appearance: none; cursor: pointer;"
                                    onfocus="this.style.background='rgba(255,255,255,0.08)'; this.style.borderColor='var(--emerald-light)'"
                                    onblur="this.style.background='rgba(255,255,255,0.05)'; this.style.borderColor='rgba(255,255,255,0.1)'"
                                >
                                    <option value="">-- Sélectionner un enseignant --</option>
                                    {% for enseignant in enseignants %}
                                        <option value="{{ enseignant.id }}">{{ enseignant.get_full_name }} ({{ enseignant.email }})</option>
                                    {% endfor %}
                                </select>
                                <i class="fas fa-chevron-down" style="position: absolute; right: 14px; top: 50%; transform: translateY(-50%); color: rgba(255,255,255,0.5); pointer-events: none;"></i>
                            </div>
                        </div>
                                                    <!-- Sélection de la matière -->
                        <div>
                            <label style="display: block; margin-bottom: 10px; font-weight: 500; color: var(--text-primary);">
                                Matière <span style="color: #ef4444;">*</span>
                            </label>
                            <div style="position: relative;">
                                <i class="fas fa-list-ol" style="position: absolute; top: 50%; left: 12px; transform: translateY(-50%); color: rgba(255,255,255,0.6); pointer-events: none;"></i>
                                <select 
                                    name="matiere" 
                                    required
                                    style="width: 100%; padding: 14px 40px 14px 40px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; color: var(--text-primary); font-size: 15px; transition: all 0.3s ease; appearance: none; cursor: pointer;"
                                    onfocus="this.style.background='rgba(255,255,255,0.08)'; this.style.borderColor='var(--emerald-light)'"
                                    onblur="this.style.background='rgba(255,255,255,0.05)'; this.style.borderColor='rgba(255,255,255,0.1)'"
                                >
                                    <option value="">-- Sélectionner une matière --</option>
                                    {% for matiere in matieres %}
                                        <option value="{{ matiere.id }}">{{ matiere.nom }}</option>
                                    {% endfor %}
                                </select>
                                <i class="fas fa-chevron-down" style="position: absolute; right: 14px; top: 50%; transform: translateY(-50%); color: rgba(255,255,255,0.5); pointer-events: none;"></i>
                            </div>
                        </div>                                                
                            <!-- Sélection de la classe -->
                        <div>
                            <label style="display: block; margin-bottom: 10px; font-weight: 500; color: var(--text-primary);">
                                Classe <span style="color: #ef4444;">*</span>
                            </label>
                            <div style="position: relative;">
                                <i class="fas fa-calendar" style="position: absolute; top: 50%; left: 12px; transform: translateY(-50%); color: rgba(255,255,255,0.6); pointer-events: none; z-index: 1;"></i>
                                <select 
                                    name="classe" 
                                    required
                                    style="width: 100%; padding: 14px 40px 14px 40px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; color: var(--text-primary); font-size: 15px; transition: all 0.3s ease; appearance: none; cursor: pointer;"
                                    onfocus="this.style.background='rgba(255,255,255,0.08)'; this.style.borderColor='var(--emerald-light)'"
                                    onblur="this.style.background='rgba(255,255,255,0.05)'; this.style.borderColor='rgba(255,255,255,0.1)'"
                                >
                                    <option value="">-- Sélectionner une classe --</option>
                                    {% for classe in classes|dictsortreversed:"id" %}
                                        <option value="{{ classe.id }}">{{ classe.nom }} ({{ classe.annee.nom }})</option>
                                    {% endfor %}
                                </select>
                                <i class="fas fa-chevron-down" style="position: absolute; right: 14px; top: 50%; transform: translateY(-50%); color: rgba(255,255,255,0.5); pointer-events: none;"></i>
                            </div>
                        </div>



                            <!-- Submit Button -->
                            <div style="margin-top: 20px;">
                                <button 
                                    type="submit"
                                    class="card-btn"
                                    style="width: 100%; padding: 16px; font-size: 17px; font-weight: 600; background: linear-gradient(135deg, var(--emerald-light), var(--emerald)); border: none; cursor: pointer;"
                                >
                                    AFFECTER L'ENSEIGNANT
                                    <i class="fas fa-check-circle" style="margin-left: 8px;"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Footer -->
            <footer class="site-footer">
                <p>Copyright © 2026 <a href="#" target="_blank">Gestion Étudiant</a> - Système de Gestion Scolaire</p>
            </footer>
        </main>
    </div>

    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/>
        </svg>
    </button>

    <style>
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
        
        /* Style pour les options du select */
        select option {
            background: var(--bg-card);
            color: var(--text-primary);
        }
    </style>
    
    <!-- JavaScript -->
    <script src="{% static 'js/templatemo-glass-admin-script.js' %}"></script>
    <script>
        // Form Validation
        const form = document.getElementById('verificationForm');
        
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const matricule = form.querySelector('[name="matricule_mesrs"]').value;
            const codePaiement = form.querySelector('[name="code_paiement"]').value;
            const anneeId = form.querySelector('[name="annee_id"]').value;
            
            // Validation basique
            if (!matricule || !codePaiement || !anneeId) {
                alert('Veuillez remplir tous les champs obligatoires.');
                return;
            }
            
            // Si toutes les validations passent, soumettre le formulaire
            console.log('Form submitted with:', {
                matricule,
                codePaiement,
                anneeId
            });
            
            // Soumettre le formulaire (décommentez pour production)
            form.submit();
        });
    </script>
</body>
</html>